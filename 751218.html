<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Social Network Analysis</title>
    <script src="https://d3js.org/d3.v5.min.js"></script>
</head>
<body>

<script>
    d3.json('graph_data.json').then(function(graph) {
        // Load node attributes
        d3.json('node_attributes.json').then(function(nodeAttributes) {
            // Create an SVG element
            var svg = d3.select('body').append('svg')
                .attr('width', 800)
                .attr('height', 600);

            // Create a force simulation
            var simulation = d3.forceSimulation(graph.nodes)
                .force('link', d3.forceLink(graph.links).id(d => d.id))
                .force('charge', d3.forceManyBody())
                .force('center', d3.forceCenter(400, 300));

            // Create links
            var links = svg.selectAll('line')
                .data(graph.links)
                .enter().append('line')
                .style('stroke', function(d) {
                    return d3.color(edge_colors[d.source.id]) || 'lightgray';
                });

            // Create nodes
            var nodes = svg.selectAll('circle')
                .data(graph.nodes)
                .enter().append('circle')
                .attr('r', function(d) {
                    return node_size[d.index];
                })
                .style('fill', function(d) {
                    return d3.color(node_colors[d.id]) || '#A4C639';
                });

            // Update node and link positions
            simulation.on('tick', function () {
                links.attr('x1', d => d.source.x)
                    .attr('y1', d => d.source.y)
                    .attr('x2', d => d.target.x)
                    .attr('y2', d => d.target.y);

                nodes.attr('cx', d => d.x)
                    .attr('cy', d => d.y);
            });

            // Add node labels with degree centrality information
            svg.selectAll('text')
                .data(graph.nodes)
                .enter().append('text')
                .attr('x', d => d.x)
                .attr('y', d => d.y)
                .text(d => d.id + '\nDegree Centrality: ' + nodeAttributes[d.id].toFixed(2))
                .style('font-size', 8)
                .style('fill', '#000000');
        });

    }).catch(function(error) {
        console.log(error);
    });
</script>

</body>
</html>
